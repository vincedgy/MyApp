!function(){"user strict";var e=angular.module("myApp",["ngRoute","ngAnimate","ngSanitize","ngToast","ngplus","ui.bootstrap","ngResource","myApp.controllers","myApp.attendeesController","myApp.sessionsListCtrl","myApp.sessionCtrl","myApp.SessionSrv","myApp.attendeesServices","myApp.directives","myApp.filters","ui.grid","ui.grid.selection"]);e.constant("config",{ver:"0.1.0",partial_dir:"partials",dirs:{base:"app/",api:{session:"/api/session/",attendee:"/api/attendee/"},views:{partials:"partials/",layout:"layout/",sessions:"sessions/",attendees:"attendees/"}}}),e.config(["ngToastProvider",function(e){e.configure({verticalPosition:"top",horizontalPosition:"left"})}]),e.config(["$routeProvider","config",function(e,s){e.when("/",{templateUrl:s.dirs.base+s.dirs.views.partials+"welcome.html",controller:"helloCtrl"}).when("/contact",{templateUrl:s.dirs.base+s.dirs.views.partials+"truc.html",controller:"helloCtrl"}).when("/about",{templateUrl:s.dirs.base+s.dirs.views.partials+"about.html",controller:"helloCtrl"}).when("/session",{templateUrl:s.dirs.base+s.dirs.views.sessions+"list.html",controller:"sessionsListCtrl"}).when("/newSession",{templateUrl:s.dirs.base+s.dirs.views.sessions+"new.html",controller:"sessionCtrl"}).when("/editSession/:_id",{templateUrl:s.dirs.base+s.dirs.views.sessions+"new.html",controller:"sessionCtrl"}).when("/session/:_id",{templateUrl:s.dirs.base+s.dirs.views.sessions+"details.html",controller:"sessionCtrl"}).when("/session/:sessionID/attendees",{templateUrl:s.dirs.base+s.dirs.views.attendees+"list.html",controller:"attendeesListCtrl"}).when("/session/:sessionID/attendees/:attendeeID",{templateUrl:s.dirs.base+s.dirs.views.attendees+"details.html",controller:"attendeeCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";var e=angular.module("myApp.attendeesController",["myApp.attendeesServices"]);e.controller("attendeeCtrl",["$scope","$location","$routeParams","Attendees",function(e,s,t,n){e.sessionID=t.sessionID||"",e.attendeeID=t.attendeeID||"",e.attendee=n.getAttendeeByID(e.sessionID,e.attendeeID),e.getAttendees=function(){e.sessionID&&s.url("/session/"+e.sessionID+"/attendees")},e.getSessions=function(){s.url("/session/")}}]),e.controller("attendeesListCtrl",["$scope","$location","$routeParams","Attendees",function(e,s,t,n){e.sessionID=t.sessionID||"",e.attendees=n.getAttendees(e.sessionID)||[],e.listAttendeesGrid={enableSorting:!0,enableRowSelection:!0,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,enableRowHeaderSelection:!1,columnDefs:[{name:"name",displayName:"Attendee (click for details)",cellTemplate:"<span>{{row.entity.title}}&nbsp;{{row.entity.firstName}}&nbsp;{{row.entity.lastName}}</span>",width:"50%"}]},e.listAttendeesGrid.onRegisterApi=function(s){e.gridApi=s,s.selection.on.rowSelectionChanged(e,function(s){var t=s.entity;e.select(t)})};var i=function(){e.listAttendeesGrid.data=e.attendees=n.getAttendees(e.sessionID)||[]};e.refresh=function(){e.attendees=[],i()},e.select=function(e){e.attendeeVTID&&e.sessionVTID&&s.url("/session/"+e.sessionVTID+"/attendees/"+e.attendeeVTID)},e.gotoSessions=function(){s.url("/session/")},i()}])}(),function(){"use strict";var e=angular.module("myApp.attendeesServices",[]);e.factory("Attendees",["$resource",function(e){var s=function(){this.attendees=[],this.AllAttendees=e("/api/session/:sessionId/attendees",{sessionId:"@id"}),this.AttendeeByID=e("/api/session/:sessionId/attendees/:attendeeId",{sessionId:"@id",attendeeId:"@attId"}),this.getAttendees=function(e){var s=[];return this.AllAttendees.query({sessionId:e},function(e){for(var t=0;t<e.length;t++)s[t]=e[t]}),this.attendees=s,this.attendees},this.getAttendeeByID=function(e,s){return this.AttendeeByID.get({sessionId:e,attendeeId:s})},this.reset=function(){console.log("Not implemented yet")}};return console.log("Init Attendees factory"),new s}])}(),function(){"use strict";var e=angular.module("myApp.directives",[]);e.directive("sessionTitle",function(){return{restrict:"EA",template:"Session [{{session.sessionID}}] : <b>{{session.title}}</b>"}}),e.directive("attendeeTitle",function(){return{restrict:"EA",template:"{{attendee.title}}&nbsp;{{attendee.firstName}}&nbsp;<b>{{attendee.lastName}}</b>"}})}(),function(){"use strict";angular.module("myApp.filters",[])}(),function(){"use strict";var e=angular.module("myApp.controllers",[]);e.controller("headerCtrl",["$scope","$location",function(e,s){e.currentLocation=null,e.isActive=function(t){return e.currentLocation||(e.currentLocation=s),t==="/"+e.currentLocation.path().split("/")[1]}}]),e.controller("footerCtrl",["$rootScope","$scope","$location",function(e,s,t){e.$on("$locationChangeSuccess",function(){s.actualLocation=t.path()})}]),e.controller("mainCtrl",["$scope","ngToast",function(e,s){e.helloMessage="Hello World !",s.create({content:"Hello !",dismissButton:!0})}]),e.controller("helloCtrl",["$scope",function(e){e.helloMessage="Hello World !"}])}(),function(){"use strict";angular.module("myApp.sessionCtrl",["myApp.SessionSrv"]).controller("sessionCtrl",["$scope","$location","$routeParams","SessionSrv","config",function(e,s,t,n){var i=t._id||"";e.session={},e.isValid=!1,e.editMode=!1;var o=s.path().split("/")[1];"newSession"===o&&(e.editMode=!1),"editSession"===o&&(e.editMode=!0);var r=function(){e.session=i?n.get({_id:i}):new n,e.isValid=e.session?!0:!1};e.getAttendees=function(e){s.url("/session/"+e.sessionID+"/attendees")},e.saveSession=function(e){e.id&&confirm("Please confirm")?e.$update({_id:e._id},function(e){s.url("/session/"+e._id)}):e.$save(function(e){s.url("/session/"+e._id)})},e.removeSession=function(e){confirm("Please confirm session "+e.sessionID+" deletion.")&&e.$remove({_id:e._id},function(e){alert("Session "+e._id+" has been removed from database."),s.url("/session/")})},e.getSessions=function(){return s.url("/session/")},e.cancel=function(){r()},r()}])}(),function(){"use strict";angular.module("myApp.SessionSrv",[]).factory("SessionSrv",["$resource","config",function(e,s){return e(s.dirs.api.session+":_id",{_id:"@id"},{update:{method:"PUT",params:{_id:"@id"}},remove:{method:"DELETE",params:{_id:"@id"}}})}])}(),function(){"use strict";angular.module("myApp.sessionsListCtrl",["myApp.SessionSrv"]).controller("sessionsListCtrl",["$scope","$location","SessionSrv",function(e,s,t){e.listSessionsGrid={enableSorting:!0,enableRowSelection:!0,multiSelect:!1,modifierKeysToMultiSelect:!1,noUnselect:!0,enableRowHeaderSelection:!1,columnDefs:[{field:"sessionID",displayName:"Session ID"},{field:"title"},{field:"duration"},{field:"startDate"},{field:"type"},{field:"trainer"},{field:"site"},{field:"room"},{field:"company"},{field:"code"}]},e.listSessionsGrid.onRegisterApi=function(s){e.gridApi=s,s.selection.on.rowSelectionChanged(e,function(s){var t=s.entity;e.select(t)})};var n=function(){e.listSessionsGrid.data=t.query()||[]};e.select=function(e){e._id&&s.url("/session/"+e._id)},e.newSession=function(){s.url("/newSession/")},n()}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImF0dGVuZGVlcy9hdHRlbmRlZXMuY3RybC5qcyIsImF0dGVuZGVlcy9hdHRlbmRlZXMuc3J2LmpzIiwibGF5b3V0L19kaXJlY3RpdmVzLmpzIiwibGF5b3V0L19maWx0ZXJzLmpzIiwibGF5b3V0L2xheW91dC5jdHJsLmpzIiwic2Vzc2lvbnMvc2Vzc2lvbi5jdHJsLmpzIiwic2Vzc2lvbnMvc2Vzc2lvbnMuc3J2LmpzIiwic2Vzc2lvbnMvc2Vzc2lvbnNMaXN0LmN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkNBSUEsV0FFQSxhQUlBLElBQUEsR0FBQSxRQUFBLE9BQUEsU0FDQSxVQUNBLFlBQ0EsYUFDQSxVQUNBLFNBQ0EsZUFDQSxhQUNBLG9CQUNBLDRCQUNBLHlCQUFBLG9CQUNBLG1CQUFBLDBCQUNBLG1CQUNBLGdCQUNBLFVBQUEscUJBR0EsR0FBQSxTQUFBLFVBR0EsSUFBQSxRQUNBLFlBQUEsV0FDQSxNQUNBLEtBQUEsT0FDQSxLQUNBLFFBQUEsZ0JBQ0EsU0FBQSxrQkFFQSxPQUNBLFNBQUEsWUFDQSxPQUFBLFVBQ0EsU0FBQSxZQUNBLFVBQUEsaUJBS0EsRUFBQSxRQUFBLGtCQUFBLFNBQUEsR0FDQSxFQUFBLFdBQ0EsaUJBQUEsTUFDQSxtQkFBQSxZQU1BLEVBQUEsUUFBQSxpQkFBQSxTQUFBLFNBQUEsRUFBQSxHQUNBLEVBQ0EsS0FBQSxLQUNBLFlBQUEsRUFBQSxLQUFBLEtBQUEsRUFBQSxLQUFBLE1BQUEsU0FBQSxlQUNBLFdBQUEsY0FFQSxLQUFBLFlBQ0EsWUFBQSxFQUFBLEtBQUEsS0FBQSxFQUFBLEtBQUEsTUFBQSxTQUFBLFlBQ0EsV0FBQSxjQUVBLEtBQUEsVUFDQSxZQUFBLEVBQUEsS0FBQSxLQUFBLEVBQUEsS0FBQSxNQUFBLFNBQUEsYUFDQSxXQUFBLGNBRUEsS0FBQSxZQUNBLFlBQUEsRUFBQSxLQUFBLEtBQUEsRUFBQSxLQUFBLE1BQUEsU0FBQSxZQUNBLFdBQUEscUJBRUEsS0FBQSxlQUNBLFlBQUEsRUFBQSxLQUFBLEtBQUEsRUFBQSxLQUFBLE1BQUEsU0FBQSxXQUNBLFdBQUEsZ0JBRUEsS0FBQSxxQkFDQSxZQUFBLEVBQUEsS0FBQSxLQUFBLEVBQUEsS0FBQSxNQUFBLFNBQUEsV0FDQSxXQUFBLGdCQUVBLEtBQUEsaUJBQ0EsWUFBQSxFQUFBLEtBQUEsS0FBQSxFQUFBLEtBQUEsTUFBQSxTQUFBLGVBQ0EsV0FBQSxnQkFFQSxLQUFBLGlDQUNBLFlBQUEsRUFBQSxLQUFBLEtBQUEsRUFBQSxLQUFBLE1BQUEsVUFBQSxZQUNBLFdBQUEsc0JBRUEsS0FBQSw2Q0FDQSxZQUFBLEVBQUEsS0FBQSxLQUFBLEVBQUEsS0FBQSxNQUFBLFVBQUEsZUFDQSxXQUFBLGlCQUVBLFdBQ0EsV0FBQSxZQy9GQSxXQUNBLFlBS0EsSUFBQSxHQUFBLFFBQUEsT0FBQSw2QkFBQSwyQkFNQSxHQUFBLFdBQUEsZ0JBQUEsU0FBQSxZQUFBLGVBQUEsWUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxVQUFBLEVBQUEsV0FBQSxHQUNBLEVBQUEsV0FBQSxFQUFBLFlBQUEsR0FDQSxFQUFBLFNBQUEsRUFBQSxnQkFBQSxFQUFBLFVBQUEsRUFBQSxZQUdBLEVBQUEsYUFBQSxXQUNBLEVBQUEsV0FDQSxFQUFBLElBQUEsWUFBQSxFQUFBLFVBQUEsZUFLQSxFQUFBLFlBQUEsV0FDQSxFQUFBLElBQUEsaUJBTUEsRUFBQSxXQUFBLHFCQUFBLFNBQUEsWUFBQSxlQUFBLFlBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsVUFBQSxFQUFBLFdBQUEsR0FDQSxFQUFBLFVBQUEsRUFBQSxhQUFBLEVBQUEsZUFFQSxFQUFBLG1CQUNBLGVBQUEsRUFDQSxvQkFBQSxFQUNBLGFBQUEsRUFDQSwyQkFBQSxFQUNBLFlBQUEsRUFDQSwwQkFBQSxFQUNBLGFBQ0EsS0FBQSxPQUNBLFlBQUEsK0JBQ0EsYUFBQSwrRkFBQSxNQUFBLFNBR0EsRUFBQSxrQkFBQSxjQUFBLFNBQUEsR0FFQSxFQUFBLFFBQUEsRUFDQSxFQUFBLFVBQUEsR0FBQSxvQkFBQSxFQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxNQUNBLEdBQUEsT0FBQSxLQUtBLElBQUEsR0FBQSxXQUNBLEVBQUEsa0JBQUEsS0FBQSxFQUFBLFVBQUEsRUFBQSxhQUFBLEVBQUEsZUFHQSxHQUFBLFFBQUEsV0FDQSxFQUFBLGFBQ0EsS0FJQSxFQUFBLE9BQUEsU0FBQSxHQUNBLEVBQUEsY0FBQSxFQUFBLGFBQ0EsRUFBQSxJQUFBLFlBQUEsRUFBQSxZQUFBLGNBQUEsRUFBQSxlQUtBLEVBQUEsYUFBQSxXQUNBLEVBQUEsSUFBQSxjQUlBLFVDakZBLFdBRUEsWUFHQSxJQUFBLEdBQUEsUUFBQSxPQUFBLDZCQUVBLEdBQUEsUUFBQSxhQUFBLFlBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxXQUNBLEtBQUEsYUFDQSxLQUFBLGFBQUEsRUFBQSxxQ0FBQSxVQUFBLFFBQ0EsS0FBQSxhQUFBLEVBQUEsaURBQUEsVUFBQSxNQUFBLFdBQUEsV0FFQSxLQUFBLGFBQUEsU0FBQSxHQUNBLEdBQUEsS0FLQSxPQUpBLE1BQUEsYUFBQSxPQUFBLFVBQUEsR0FBQSxTQUFBLEdBQ0EsSUFBQSxHQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLEtBRUEsS0FBQSxVQUFBLEVBQ0EsS0FBQSxXQUdBLEtBQUEsZ0JBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSxNQUFBLGFBQUEsS0FBQSxVQUFBLEVBQUEsV0FBQSxLQUdBLEtBQUEsTUFBQSxXQUNBLFFBQUEsSUFBQSx3QkFLQSxPQURBLFNBQUEsSUFBQSwwQkFDQSxHQUFBLFNDaENBLFdBQ0EsWUFFQSxJQUFBLEdBQUEsUUFBQSxPQUFBLHNCQUVBLEdBQUEsVUFBQSxlQUFBLFdBQ0EsT0FDQSxTQUFBLEtBQ0EsU0FBQSxnRUFJQSxFQUFBLFVBQUEsZ0JBQUEsV0FDQSxPQUNBLFNBQUEsS0FDQSxTQUFBLHlGQ2ZBLFdBQ0EsWUFFQSxTQUFBLE9BQUEsdUJDSEEsV0FFQSxZQUtBLElBQUEsR0FBQSxRQUFBLE9BQUEsdUJBR0EsR0FBQSxXQUFBLGNBQUEsU0FBQSxZQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsZ0JBQUEsS0FDQSxFQUFBLFNBQUEsU0FBQSxHQUlBLE1BSEEsR0FBQSxrQkFDQSxFQUFBLGdCQUFBLEdBRUEsSUFBQSxJQUFBLEVBQUEsZ0JBQUEsT0FBQSxNQUFBLEtBQUEsT0FNQSxFQUFBLFdBQUEsY0FBQSxhQUFBLFNBQUEsWUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsSUFBQSx5QkFBQSxXQUNBLEVBQUEsZUFBQSxFQUFBLFlBS0EsRUFBQSxXQUFBLFlBQUEsU0FBQSxVQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsYUFBQSxnQkFFQSxFQUFBLFFBQ0EsUUFBQSxVQUNBLGVBQUEsT0FLQSxFQUFBLFdBQUEsYUFBQSxTQUFBLFNBQUEsR0FDQSxFQUFBLGFBQUEsc0JDckNBLFdBQ0EsWUFLQSxTQUFBLE9BQUEscUJBQUEscUJBQ0EsV0FBQSxlQUFBLFNBQUEsWUFBQSxlQUFBLGFBQUEsU0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsS0FBQSxFQUVBLEdBQUEsV0FDQSxFQUFBLFNBQUEsRUFDQSxFQUFBLFVBQUEsQ0FFQSxJQUFBLEdBQUEsRUFBQSxPQUFBLE1BQUEsS0FBQSxFQUNBLGdCQUFBLElBQUEsRUFBQSxVQUFBLEdBQ0EsZ0JBQUEsSUFBQSxFQUFBLFVBQUEsRUFFQSxJQUFBLEdBQUEsV0FFQSxFQUFBLFFBREEsRUFDQSxFQUFBLEtBQUEsSUFBQSxJQURBLEdBQUEsR0FFQSxFQUFBLFFBQUEsRUFBQSxTQUFBLEdBQUEsRUFJQSxHQUFBLGFBQUEsU0FBQSxHQUNBLEVBQUEsSUFBQSxZQUFBLEVBQUEsVUFBQSxlQUdBLEVBQUEsWUFBQSxTQUFBLEdBQ0EsRUFBQSxJQUFBLFFBQUEsa0JBQ0EsRUFBQSxTQUFBLElBQUEsRUFBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsWUFBQSxFQUFBLE9BR0EsRUFBQSxNQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsWUFBQSxFQUFBLFFBS0EsRUFBQSxjQUFBLFNBQUEsR0FDQSxRQUFBLDBCQUFBLEVBQUEsVUFBQSxlQUNBLEVBQUEsU0FBQSxJQUFBLEVBQUEsS0FBQSxTQUFBLEdBQ0EsTUFBQSxXQUFBLEVBQUEsSUFBQSxvQ0FDQSxFQUFBLElBQUEsZ0JBTUEsRUFBQSxZQUFBLFdBQ0EsTUFBQSxHQUFBLElBQUEsY0FJQSxFQUFBLE9BQUEsV0FDQSxLQUlBLFVDakVBLFdBRUEsWUFFQSxTQUFBLE9BQUEsdUJBQ0EsUUFBQSxjQUFBLFlBQUEsU0FBQSxTQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsRUFBQSxLQUFBLElBQUEsUUFBQSxRQUFBLElBQUEsUUFFQSxRQUFBLE9BQUEsTUFBQSxRQUFBLElBQUEsUUFDQSxRQUFBLE9BQUEsU0FBQSxRQUFBLElBQUEsZ0JDVEEsV0FDQSxZQUtBLFNBQUEsT0FBQSwwQkFBQSxxQkFDQSxXQUFBLG9CQUFBLFNBQUEsWUFBQSxhQUFBLFNBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxrQkFDQSxlQUFBLEVBQ0Esb0JBQUEsRUFDQSxhQUFBLEVBQ0EsMkJBQUEsRUFDQSxZQUFBLEVBQ0EsMEJBQUEsRUFDQSxhQUNBLE1BQUEsWUFBQSxZQUFBLGVBQ0EsTUFBQSxVQUNBLE1BQUEsYUFDQSxNQUFBLGNBQ0EsTUFBQSxTQUNBLE1BQUEsWUFDQSxNQUFBLFNBQ0EsTUFBQSxTQUNBLE1BQUEsWUFDQSxNQUFBLFVBR0EsRUFBQSxpQkFBQSxjQUFBLFNBQUEsR0FFQSxFQUFBLFFBQUEsRUFDQSxFQUFBLFVBQUEsR0FBQSxvQkFBQSxFQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxNQUNBLEdBQUEsT0FBQSxLQUlBLElBQUEsR0FBQSxXQUNBLEVBQUEsaUJBQUEsS0FBQSxFQUFBLFlBS0EsR0FBQSxPQUFBLFNBQUEsR0FDQSxFQUFBLEtBQ0EsRUFBQSxJQUFBLFlBQUEsRUFBQSxNQUtBLEVBQUEsV0FBQSxXQUNBLEVBQUEsSUFBQSxpQkFJQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBUcmFpbmluZyBvbiAyMS8xMC8yMDE0LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZXIgc3RyaWN0JztcclxuXHJcbiAgICAvKiBjb25maWd1cmF0aW9ucyAqL1xyXG5cclxuICAgIHZhciBteUFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFtcclxuICAgICAgICAnbmdSb3V0ZSdcclxuICAgICAgICAsICduZ0FuaW1hdGUnXHJcbiAgICAgICAgLCAnbmdTYW5pdGl6ZSdcclxuICAgICAgICAsICduZ1RvYXN0J1xyXG4gICAgICAgICwgJ25ncGx1cydcclxuICAgICAgICAsICd1aS5ib290c3RyYXAnXHJcbiAgICAgICAgLCAnbmdSZXNvdXJjZSdcclxuICAgICAgICAsICdteUFwcC5jb250cm9sbGVycydcclxuICAgICAgICAsICdteUFwcC5hdHRlbmRlZXNDb250cm9sbGVyJ1xyXG4gICAgICAgICwgJ215QXBwLnNlc3Npb25zTGlzdEN0cmwnLCAnbXlBcHAuc2Vzc2lvbkN0cmwnXHJcbiAgICAgICAgLCAnbXlBcHAuU2Vzc2lvblNydicsICdteUFwcC5hdHRlbmRlZXNTZXJ2aWNlcydcclxuICAgICAgICAsICdteUFwcC5kaXJlY3RpdmVzJ1xyXG4gICAgICAgICwgJ215QXBwLmZpbHRlcnMnXHJcbiAgICAgICAgLCAndWkuZ3JpZCcsICd1aS5ncmlkLnNlbGVjdGlvbiddKTtcclxuXHJcbi8vIEdsb2JhbCBjb25maWcgY29uc3RhbnRzIGZvciBBcHBsaWNhdGlvblxyXG4gICAgbXlBcHAuY29uc3RhbnQoJ2NvbmZpZycsXHJcbiAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgJ3Zlcic6ICcwLjEuMCcsXHJcbiAgICAgICAgICAgICdwYXJ0aWFsX2Rpcic6ICdwYXJ0aWFscycsXHJcbiAgICAgICAgICAgICdkaXJzJzoge1xyXG4gICAgICAgICAgICAgICAgJ2Jhc2UnOiAnYXBwLycsXHJcbiAgICAgICAgICAgICAgICAnYXBpJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICdzZXNzaW9uJzogJy9hcGkvc2Vzc2lvbi8nLFxyXG4gICAgICAgICAgICAgICAgICAgICdhdHRlbmRlZSc6ICcvYXBpL2F0dGVuZGVlLydcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAndmlld3MnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3BhcnRpYWxzJzogJ3BhcnRpYWxzLycsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2xheW91dCc6ICdsYXlvdXQvJyxcclxuICAgICAgICAgICAgICAgICAgICAnc2Vzc2lvbnMnOiAnc2Vzc2lvbnMvJyxcclxuICAgICAgICAgICAgICAgICAgICAnYXR0ZW5kZWVzJzogJ2F0dGVuZGVlcy8nXHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vIG5nVG9hc3QgZ2VuZXJhbCBjb25maWdcclxuICAgIG15QXBwLmNvbmZpZyhbJ25nVG9hc3RQcm92aWRlcicsIGZ1bmN0aW9uKG5nVG9hc3QpIHtcclxuICAgICAgICAgICAgbmdUb2FzdC5jb25maWd1cmUoe1xyXG4gICAgICAgICAgICAgICAgdmVydGljYWxQb3NpdGlvbjogJ3RvcCcsXHJcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsUG9zaXRpb246ICdsZWZ0J1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XSk7XHJcblxyXG5cclxuICAgIC8vIHJvdXRlIGNvbmZpZ3VyYXRpb25zXHJcbiAgICBteUFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsICdjb25maWcnLCBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsIGNvbmZpZykge1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyLlxyXG4gICAgICAgICAgICB3aGVuKCcvJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5kaXJzLmJhc2UgKyBjb25maWcuZGlycy52aWV3cy5wYXJ0aWFscyArICd3ZWxjb21lLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2hlbGxvQ3RybCdcclxuICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgIHdoZW4oJy9jb250YWN0Jywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5kaXJzLmJhc2UgKyBjb25maWcuZGlycy52aWV3cy5wYXJ0aWFscyArICd0cnVjLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2hlbGxvQ3RybCdcclxuICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgIHdoZW4oJy9hYm91dCcsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuZGlycy5iYXNlICsgY29uZmlnLmRpcnMudmlld3MucGFydGlhbHMgKyAnYWJvdXQuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnaGVsbG9DdHJsJ1xyXG4gICAgICAgICAgICB9KS5cclxuICAgICAgICAgICAgd2hlbignL3Nlc3Npb24nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogY29uZmlnLmRpcnMuYmFzZSArIGNvbmZpZy5kaXJzLnZpZXdzLnNlc3Npb25zICsgJ2xpc3QuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2Vzc2lvbnNMaXN0Q3RybCdcclxuICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgIHdoZW4oJy9uZXdTZXNzaW9uJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5kaXJzLmJhc2UgKyBjb25maWcuZGlycy52aWV3cy5zZXNzaW9ucyArICduZXcuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2Vzc2lvbkN0cmwnXHJcbiAgICAgICAgICAgIH0pLlxyXG4gICAgICAgICAgICB3aGVuKCcvZWRpdFNlc3Npb24vOl9pZCcsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuZGlycy5iYXNlICsgY29uZmlnLmRpcnMudmlld3Muc2Vzc2lvbnMgKyAnbmV3Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3Nlc3Npb25DdHJsJ1xyXG4gICAgICAgICAgICB9KS5cclxuICAgICAgICAgICAgd2hlbignL3Nlc3Npb24vOl9pZCcsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuZGlycy5iYXNlICsgY29uZmlnLmRpcnMudmlld3Muc2Vzc2lvbnMgKyAnZGV0YWlscy5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzZXNzaW9uQ3RybCdcclxuICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgIHdoZW4oJy9zZXNzaW9uLzpzZXNzaW9uSUQvYXR0ZW5kZWVzJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5kaXJzLmJhc2UgKyBjb25maWcuZGlycy52aWV3cy5hdHRlbmRlZXMgKyAnbGlzdC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhdHRlbmRlZXNMaXN0Q3RybCdcclxuICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgIHdoZW4oJy9zZXNzaW9uLzpzZXNzaW9uSUQvYXR0ZW5kZWVzLzphdHRlbmRlZUlEJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5kaXJzLmJhc2UgKyBjb25maWcuZGlycy52aWV3cy5hdHRlbmRlZXMgKyAnZGV0YWlscy5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhdHRlbmRlZUN0cmwnXHJcbiAgICAgICAgICAgIH0pLlxyXG4gICAgICAgICAgICBvdGhlcndpc2Uoe1xyXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJy8nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfV0pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuXHJcbiAgICAvKiBjb250cm9sbGVycyAqL1xyXG5cclxuICAgIHZhciBhdHRlbmRlZXNDb250cm9sbGVyID0gYW5ndWxhci5tb2R1bGUoJ215QXBwLmF0dGVuZGVlc0NvbnRyb2xsZXInLCBbJ215QXBwLmF0dGVuZGVlc1NlcnZpY2VzJ10pO1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIEF0dGVuZGVlc1xyXG4gICAgICovXHJcbiAgICBhdHRlbmRlZXNDb250cm9sbGVyLmNvbnRyb2xsZXIoJ2F0dGVuZGVlQ3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckcm91dGVQYXJhbXMnLCAnQXR0ZW5kZWVzJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIEF0dGVuZGVlcykge1xyXG4gICAgICAgICRzY29wZS5zZXNzaW9uSUQgPSAkcm91dGVQYXJhbXMuc2Vzc2lvbklEIHx8ICcnO1xyXG4gICAgICAgICRzY29wZS5hdHRlbmRlZUlEID0gJHJvdXRlUGFyYW1zLmF0dGVuZGVlSUQgfHwgJyc7XHJcbiAgICAgICAgJHNjb3BlLmF0dGVuZGVlID0gQXR0ZW5kZWVzLmdldEF0dGVuZGVlQnlJRCgkc2NvcGUuc2Vzc2lvbklELCAkc2NvcGUuYXR0ZW5kZWVJRCk7XHJcblxyXG4gICAgICAgIC8vIEdvdCB0byBhdHRlbmRlZXMgbGlzdCBmb3IgdGhpcyBzZXNzaW9uXHJcbiAgICAgICAgJHNjb3BlLmdldEF0dGVuZGVlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5zZXNzaW9uSUQpIHtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi51cmwoJy9zZXNzaW9uLycgKyAkc2NvcGUuc2Vzc2lvbklEICsgJy9hdHRlbmRlZXMnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEdvdCB0byBhdHRlbmRlZXMgbGlzdCBmb3IgdGhpcyBzZXNzaW9uXHJcbiAgICAgICAgJHNjb3BlLmdldFNlc3Npb25zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbG9jYXRpb24udXJsKCcvc2Vzc2lvbi8nKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICB9XSk7XHJcblxyXG4gICAgYXR0ZW5kZWVzQ29udHJvbGxlci5jb250cm9sbGVyKCdhdHRlbmRlZXNMaXN0Q3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckcm91dGVQYXJhbXMnLCAnQXR0ZW5kZWVzJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIEF0dGVuZGVlcykge1xyXG4gICAgICAgICRzY29wZS5zZXNzaW9uSUQgPSAkcm91dGVQYXJhbXMuc2Vzc2lvbklEIHx8ICcnO1xyXG4gICAgICAgICRzY29wZS5hdHRlbmRlZXMgPSBBdHRlbmRlZXMuZ2V0QXR0ZW5kZWVzKCRzY29wZS5zZXNzaW9uSUQpIHx8IFtdO1xyXG5cclxuICAgICAgICAkc2NvcGUubGlzdEF0dGVuZGVlc0dyaWQgPSB7XHJcbiAgICAgICAgICAgIGVuYWJsZVNvcnRpbmc6IHRydWUsXHJcbiAgICAgICAgICAgIGVuYWJsZVJvd1NlbGVjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3Q6IGZhbHNlLFxyXG4gICAgICAgICAgICBtb2RpZmllcktleXNUb011bHRpU2VsZWN0OiBmYWxzZSxcclxuICAgICAgICAgICAgbm9VbnNlbGVjdDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5hYmxlUm93SGVhZGVyU2VsZWN0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgY29sdW1uRGVmczogW1xyXG4gICAgICAgICAgICAgICAgeyAgIG5hbWU6ICduYW1lJyxcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0F0dGVuZGVlIChjbGljayBmb3IgZGV0YWlscyknLFxyXG4gICAgICAgICAgICAgICAgICAgIGNlbGxUZW1wbGF0ZTogJzxzcGFuPnt7cm93LmVudGl0eS50aXRsZX19Jm5ic3A7e3tyb3cuZW50aXR5LmZpcnN0TmFtZX19Jm5ic3A7e3tyb3cuZW50aXR5Lmxhc3ROYW1lfX08L3NwYW4+JywgJ3dpZHRoJzogJzUwJSd9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5saXN0QXR0ZW5kZWVzR3JpZC5vblJlZ2lzdGVyQXBpID0gZnVuY3Rpb24gKGdyaWRBcGkpIHtcclxuICAgICAgICAgICAgLy9zZXQgZ3JpZEFwaSBvbiBzY29wZVxyXG4gICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaSA9IGdyaWRBcGk7XHJcbiAgICAgICAgICAgIGdyaWRBcGkuc2VsZWN0aW9uLm9uLnJvd1NlbGVjdGlvbkNoYW5nZWQoJHNjb3BlLCBmdW5jdGlvbiAocm93KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXR0ZW5kZWUgPSByb3cuZW50aXR5O1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdChhdHRlbmRlZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxpc3RBdHRlbmRlZXNHcmlkLmRhdGEgPSAkc2NvcGUuYXR0ZW5kZWVzID0gQXR0ZW5kZWVzLmdldEF0dGVuZGVlcygkc2NvcGUuc2Vzc2lvbklEKSB8fCBbXTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmF0dGVuZGVlcyA9IFtdO1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgaXMgdGFrZW4gZGlyZWN0bHkgZnJvbSB0aGUgc2NvcGUgdG9vXHJcbiAgICAgICAgJHNjb3BlLnNlbGVjdCA9IGZ1bmN0aW9uIChhdHRlbmRlZSkge1xyXG4gICAgICAgICAgICBpZiAoYXR0ZW5kZWUuYXR0ZW5kZWVWVElEICYmIGF0dGVuZGVlLnNlc3Npb25WVElEKSB7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24udXJsKCcvc2Vzc2lvbi8nICsgYXR0ZW5kZWUuc2Vzc2lvblZUSUQgKyAnL2F0dGVuZGVlcy8nICsgYXR0ZW5kZWUuYXR0ZW5kZWVWVElEKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEdvdCB0byBhdHRlbmRlZXMgbGlzdCBmb3IgdGhpcyBzZXNzaW9uXHJcbiAgICAgICAgJHNjb3BlLmdvdG9TZXNzaW9ucyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGxvY2F0aW9uLnVybCgnL3Nlc3Npb24vJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gSW5pdCBjb250cm9sbGVyXHJcbiAgICAgICAgaW5pdCgpO1xyXG4gICAgfV0pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcblxyXG4gICAgdmFyIGF0dGVuZGVlc1NlcnZpY2VzID0gYW5ndWxhci5tb2R1bGUoJ215QXBwLmF0dGVuZGVlc1NlcnZpY2VzJywgW10pO1xyXG5cclxuICAgIGF0dGVuZGVlc1NlcnZpY2VzLmZhY3RvcnkoJ0F0dGVuZGVlcycsIGZ1bmN0aW9uICgkcmVzb3VyY2UpIHtcclxuICAgICAgICB2YXIgQXR0ZW5kZWVzRmFjdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5hdHRlbmRlZXMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5BbGxBdHRlbmRlZXMgPSAkcmVzb3VyY2UoJy9hcGkvc2Vzc2lvbi86c2Vzc2lvbklkL2F0dGVuZGVlcycsIHtzZXNzaW9uSWQ6ICdAaWQnfSk7XHJcbiAgICAgICAgICAgIHRoaXMuQXR0ZW5kZWVCeUlEID0gJHJlc291cmNlKCcvYXBpL3Nlc3Npb24vOnNlc3Npb25JZC9hdHRlbmRlZXMvOmF0dGVuZGVlSWQnLCB7c2Vzc2lvbklkOiAnQGlkJywgYXR0ZW5kZWVJZDogJ0BhdHRJZCd9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QXR0ZW5kZWVzID0gZnVuY3Rpb24gKHNlc3Npb25JRCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGF0dGVuZGVlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5BbGxBdHRlbmRlZXMucXVlcnkoe3Nlc3Npb25JZDogc2Vzc2lvbklEfSwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIGF0dGVuZGVlc1tpXSA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0ZW5kZWVzID0gYXR0ZW5kZWVzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0ZW5kZWVzO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5nZXRBdHRlbmRlZUJ5SUQgPSBmdW5jdGlvbiAoc2Vzc2lvbklELCBhdHRlbmRlZUlEKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5BdHRlbmRlZUJ5SUQuZ2V0KHtzZXNzaW9uSWQ6IHNlc3Npb25JRCwgYXR0ZW5kZWVJZDogYXR0ZW5kZWVJRH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOb3QgaW1wbGVtZW50ZWQgeWV0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnSW5pdCBBdHRlbmRlZXMgZmFjdG9yeScpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQXR0ZW5kZWVzRmFjdG9yeSgpO1xyXG4gICAgfSk7XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIGRpcmVjdGl2ZXMgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAuZGlyZWN0aXZlcycsIFtdKTtcclxuXHJcbiAgICBkaXJlY3RpdmVzLmRpcmVjdGl2ZSgnc2Vzc2lvblRpdGxlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJ1Nlc3Npb24gW3t7c2Vzc2lvbi5zZXNzaW9uSUR9fV0gOiA8Yj57e3Nlc3Npb24udGl0bGV9fTwvYj4nXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZGlyZWN0aXZlcy5kaXJlY3RpdmUoJ2F0dGVuZGVlVGl0bGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAne3thdHRlbmRlZS50aXRsZX19Jm5ic3A7e3thdHRlbmRlZS5maXJzdE5hbWV9fSZuYnNwOzxiPnt7YXR0ZW5kZWUubGFzdE5hbWV9fTwvYj4nXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgZmlsdGVycyA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcC5maWx0ZXJzJywgW10pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcblxyXG4gICAgLyogY29udHJvbGxlcnMgKi9cclxuXHJcbiAgICB2YXIgY29udHJvbGxlcnMgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAuY29udHJvbGxlcnMnLCBbXSk7XHJcblxyXG4gICAgLy8gaGVhZGVyQ3RybFxyXG4gICAgY29udHJvbGxlcnMuY29udHJvbGxlcignaGVhZGVyQ3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbikge1xyXG4gICAgICAgICRzY29wZS5jdXJyZW50TG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uICh2aWV3TG9jYXRpb24pIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUuY3VycmVudExvY2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudExvY2F0aW9uID0gJGxvY2F0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB2aWV3TG9jYXRpb24gPT09ICcvJyArICRzY29wZS5jdXJyZW50TG9jYXRpb24ucGF0aCgpLnNwbGl0KCcvJylbMV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1dKTtcclxuXHJcbiAgICAvLyBmb290ZXJDdHJsXHJcbiAgICBjb250cm9sbGVycy5jb250cm9sbGVyKCdmb290ZXJDdHJsJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCAkbG9jYXRpb24pIHtcclxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJGxvY2F0aW9uQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0dWFsTG9jYXRpb24gPSAkbG9jYXRpb24ucGF0aCgpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XSk7XHJcblxyXG4gICAgLy8gbWFpbkN0cmxcclxuICAgIGNvbnRyb2xsZXJzLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgWyckc2NvcGUnLCAnbmdUb2FzdCcsIGZ1bmN0aW9uICgkc2NvcGUsIG5nVG9hc3QpIHtcclxuICAgICAgICAkc2NvcGUuaGVsbG9NZXNzYWdlID0gJ0hlbGxvIFdvcmxkICEnO1xyXG4gICAgICAgIC8vIFRFU1RcclxuICAgICAgICBuZ1RvYXN0LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAnY29udGVudCc6ICdIZWxsbyAhJyxcclxuICAgICAgICAgICAgICAgICdkaXNtaXNzQnV0dG9uJzogdHJ1ZSx9XHJcbiAgICAgICAgKTtcclxuICAgIH1dKTtcclxuXHJcbiAgICAvLyBoZWxsb0N0cmxcclxuICAgIGNvbnRyb2xsZXJzLmNvbnRyb2xsZXIoJ2hlbGxvQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24gKCRzY29wZSkge1xyXG4gICAgICAgICRzY29wZS5oZWxsb01lc3NhZ2UgPSAnSGVsbG8gV29ybGQgISc7XHJcbiAgICB9XSk7XHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IFZpbmNlbnQgb24gMDEvMTEvMjAxNC5cclxuICovXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyogY29udHJvbGxlcnMgKi9cclxuXHJcbiAgICB2YXIgc2Vzc2lvbkN0cmwgPVxyXG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdteUFwcC5zZXNzaW9uQ3RybCcsIFsnbXlBcHAuU2Vzc2lvblNydiddKVxyXG4gICAgICAgICAgICAuY29udHJvbGxlcignc2Vzc2lvbkN0cmwnLCBbJyRzY29wZScsICckbG9jYXRpb24nLCAnJHJvdXRlUGFyYW1zJywgJ1Nlc3Npb25TcnYnLCAnY29uZmlnJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkcm91dGVQYXJhbXMsIFNlc3Npb25TcnYsIGNvbmZpZykge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwYXNzZWRJZCA9ICRyb3V0ZVBhcmFtcy5faWQgfHwgJyc7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlc3Npb24gPSB7fTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pc1ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudExvY2F0aW9uID0gJGxvY2F0aW9uLnBhdGgoKS5zcGxpdCgnLycpWzFdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMb2NhdGlvbiA9PT0gJ25ld1Nlc3Npb24nKSAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TG9jYXRpb24gPT09ICdlZGl0U2Vzc2lvbicpICRzY29wZS5lZGl0TW9kZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEgcGFzc2VkSWQpICRzY29wZS5zZXNzaW9uID0gbmV3IFNlc3Npb25TcnYoKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlICAgICAgICAgICAgJHNjb3BlLnNlc3Npb24gPSBTZXNzaW9uU3J2LmdldCh7X2lkOiBwYXNzZWRJZH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1ZhbGlkID0gJHNjb3BlLnNlc3Npb24gPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEdvdCB0byBhdHRlbmRlZXMgbGlzdCBmb3IgdGhpcyBzZXNzaW9uXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0QXR0ZW5kZWVzID0gZnVuY3Rpb24gKHNlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24udXJsKCcvc2Vzc2lvbi8nICsgc2Vzc2lvbi5zZXNzaW9uSUQgKyAnL2F0dGVuZGVlcycpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZVNlc3Npb24gPSBmdW5jdGlvbiAoc2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLmlkICYmIGNvbmZpcm0oJ1BsZWFzZSBjb25maXJtJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbi4kdXBkYXRlKHtfaWQ6IHNlc3Npb24uX2lkfSwgZnVuY3Rpb24oc2F2ZWRTZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24udXJsKCcvc2Vzc2lvbi8nK3NhdmVkU2Vzc2lvbi5faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uLiRzYXZlKGZ1bmN0aW9uKHNhdmVkU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnVybCgnL3Nlc3Npb24vJytzYXZlZFNlc3Npb24uX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVtb3ZlU2Vzc2lvbiA9IGZ1bmN0aW9uIChzZXNzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oJ1BsZWFzZSBjb25maXJtIHNlc3Npb24gJyArIHNlc3Npb24uc2Vzc2lvbklEICsgJyBkZWxldGlvbi4nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uLiRyZW1vdmUoe19pZDogc2Vzc2lvbi5faWR9LCBmdW5jdGlvbihyZW1vdmVkU2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ1Nlc3Npb24gJyArIHJlbW92ZWRTZXNzaW9uLl9pZCArICcgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIGRhdGFiYXNlLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnVybCgnL3Nlc3Npb24vJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRTZXNzaW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkbG9jYXRpb24udXJsKCcvc2Vzc2lvbi8nKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgaXMgdGFrZW4gZGlyZWN0bHkgZnJvbSB0aGUgc2NvcGUgdG9vXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBjb250cm9sbGVyXHJcbiAgICAgICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgICAgIH1dKTtcclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgU2Vzc2lvblNydiA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcC5TZXNzaW9uU3J2JywgW10pXHJcbiAgICAgICAgLmZhY3RvcnkoJ1Nlc3Npb25TcnYnLCBbJyRyZXNvdXJjZScsICdjb25maWcnLCBmdW5jdGlvbiAoJHJlc291cmNlLCBjb25maWcpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRyZXNvdXJjZShjb25maWcuZGlycy5hcGkuc2Vzc2lvbiArICc6X2lkJywge19pZDonQGlkJ30sXHJcbiAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGU6IHttZXRob2Q6ICdQVVQnLCBwYXJhbXMgOiB7X2lkOidAaWQnfX0sXHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlOiB7bWV0aG9kOiAnREVMRVRFJywgcGFyYW1zIDoge19pZDonQGlkJ319XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XSlcclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8qIGNvbnRyb2xsZXJzICovXHJcblxyXG4gICAgdmFyIHNlc3Npb25zTGlzdEN0cmwgPVxyXG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKCdteUFwcC5zZXNzaW9uc0xpc3RDdHJsJywgWydteUFwcC5TZXNzaW9uU3J2J10pXHJcbiAgICAgICAgICAgIC5jb250cm9sbGVyKCdzZXNzaW9uc0xpc3RDdHJsJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ1Nlc3Npb25TcnYnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIFNlc3Npb25TcnYpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlzdFNlc3Npb25zR3JpZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBlbmFibGVTb3J0aW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVJvd1NlbGVjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtdWx0aVNlbGVjdDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJLZXlzVG9NdWx0aVNlbGVjdDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgbm9VbnNlbGVjdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBlbmFibGVSb3dIZWFkZXJTZWxlY3Rpb246IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbkRlZnM6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJzZXNzaW9uSURcIiwgZGlzcGxheU5hbWU6IFwiU2Vzc2lvbiBJRFwifSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJ0aXRsZVwifSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJkdXJhdGlvblwifSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJzdGFydERhdGVcIn0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZmllbGQ6IFwidHlwZVwiIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZmllbGQ6IFwidHJhaW5lclwifSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJzaXRlXCJ9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGZpZWxkOiBcInJvb21cIn0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZmllbGQ6IFwiY29tcGFueVwifSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBmaWVsZDogXCJjb2RlXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5saXN0U2Vzc2lvbnNHcmlkLm9uUmVnaXN0ZXJBcGkgPSBmdW5jdGlvbiAoZ3JpZEFwaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0IGdyaWRBcGkgb24gc2NvcGVcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ3JpZEFwaSA9IGdyaWRBcGk7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEFwaS5zZWxlY3Rpb24ub24ucm93U2VsZWN0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChyb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlc3Npb24gPSByb3cuZW50aXR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0KHNlc3Npb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGlzdFNlc3Npb25zR3JpZC5kYXRhID0gU2Vzc2lvblNydi5xdWVyeSgpIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVmFsaWRhdGUgaXMgdGFrZW4gZGlyZWN0bHkgZnJvbSB0aGUgc2NvcGUgdG9vXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ID0gZnVuY3Rpb24gKHNlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vzc2lvbi5faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnVybCgnL3Nlc3Npb24vJyArIHNlc3Npb24uX2lkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFZhbGlkYXRlIGlzIHRha2VuIGRpcmVjdGx5IGZyb20gdGhlIHNjb3BlIHRvb1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5ld1Nlc3Npb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnVybCgnL25ld1Nlc3Npb24vJyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEluaXQgY29udHJvbGxlclxyXG4gICAgICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgICAgICB9XSk7XHJcblxyXG59KVxyXG4oKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=